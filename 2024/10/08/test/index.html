<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Title -->
<title>Nginxé…ç½® - YueFeng&#39;s Blog</title>

<!-- Icon -->
<link rel="icon" href="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg">

<!-- Fonts -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" as="style" onload="this.onload=null, this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript>



<!-- Style -->

<link rel="stylesheet" href="/styles/main.css">

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-pure@1.0.1/dist/main.css"> -->





    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


    <meta name="generator" content="Hexo 7.3.0"></head>
    <body>
        <div class="main gt-bg-theme-color-first">
            <div class="main-content">
                <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="https://d33wubrfki0l68.cloudfront.net/6657ba50e702d84afb32fe846bed54fba1a77add/827ae/logo.svg" alt="å¤´åƒ">
        <div class="site-name gt-c-content-color-first">
            YueFeng&#39;s Blog
        </div>
    </a>
    <button aria-label="Navbar Toggler" class="navbar-toggler" type="button" id="changeNavbar">
        <i class="gt-c-content-color-first" style="font-size: 18px;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" height="18px" fill="currentColor">
                <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" />
            </svg>
        </i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center; ">
            
                <div class="nav-item">
                    <a href="/" class="menu gt-a-link" target="_self">é¦–é¡µ</a>
                </div>
            
                <div class="nav-item">
                    <a href="/archives/" class="menu gt-a-link" target="_self">å½’æ¡£</a>
                </div>
            
                <div class="nav-item">
                    <a href="/tags/" class="menu gt-a-link" target="_self">æ ‡ç­¾</a>
                </div>
            
                <div class="nav-item">
                    <a href="/friends/" class="menu gt-a-link" target="_self">å‹é“¾</a>
                </div>
            
        </div>
    </div>
</nav>

<script>
    /* ç§»åŠ¨ç«¯å¯¼èˆªæ å±•å¼€/æ”¶èµ·åˆ‡æ¢ */
    document.getElementById('changeNavbar').onclick = function() {
        let element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else { 
            element.style.display = 'none';
        }
    }
</script>

                <div class="post-container">
    <div class="post-detail gt-bg-theme-color-second gt-c-content-color-first">
        <article class="gt-post-content">
            <h1 class="post-title">Nginxé…ç½®</h1>
            <div class="post-info">
                <time class="post-time gt-c-content-color-first">
                    å‘å¸ƒäº 2024-10-08 |</time>
                
                    
                        #<a href="/tags/Docs%E6%96%87%E6%A1%A3/" class="post-tag">
                            Docsæ–‡æ¡£</a>
                    
                
            </div>
            <hr>
            <div class="post-content gt-c-content-color-first">
                <blockquote>
<p>è®°å½•Nginxé…ç½®ä¸ä½¿ç”¨</p>
</blockquote>
<hr>
<h4 id="ğŸ–‹-Nginxçš„ä¸‹è½½"><a href="#ğŸ–‹-Nginxçš„ä¸‹è½½" class="headerlink" title="ğŸ–‹ Nginxçš„ä¸‹è½½"></a>ğŸ–‹ Nginxçš„ä¸‹è½½</h4><ul>
<li>Windowsçš„ä¸‹è½½åœ°å€ï¼ˆå®˜ç½‘ï¼‰ï¼š<ul>
<li><a target="_blank" rel="noopener" href="http://nginx.org/">Nginxå®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://nginx.p2hp.com/">Nginxä¸­æ–‡ç½‘</a></li>
</ul>
</li>
</ul>
<h4 id="Nginxçš„ä½¿ç”¨"><a href="#Nginxçš„ä½¿ç”¨" class="headerlink" title="Nginxçš„ä½¿ç”¨"></a>Nginxçš„ä½¿ç”¨</h4><ul>
<li><p>å¸¸ç”¨ç›®å½•ç»“æ„</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>æè¿°</th>
<th>æ–‡ä»¶</th>
</tr>
</thead>
<tbody><tr>
<td>conf</td>
<td>å­˜æ”¾Nginxé…ç½®æ–‡ä»¶çš„ç›®å½•</td>
<td>é…ç½®æ–‡ä»¶nginx.conf</td>
</tr>
<tr>
<td>docs</td>
<td>å­˜æ”¾é»˜è®¤çš„Htmlç½‘é¡µ</td>
<td>indexé¡µå’Œ50xé”™è¯¯é¡µ</td>
</tr>
<tr>
<td>logs</td>
<td>å­˜å‚¨Nginxè¿è¡Œæ—¥å¿—</td>
<td>accesså’Œerroræ—¥å¿—</td>
</tr>
</tbody></table>
</li>
<li><p>é…ç½®æ–‡ä»¶</p>
</li>
</ul>
<pre><code class="hljs nginx">
<span class="hljs-comment">### å…¨å±€å—  ###</span>
<span class="hljs-attribute">user</span> nginx;  <span class="hljs-comment"># è®¾ç½® Nginx å·¥ä½œè¿›ç¨‹è¿è¡Œçš„èº«ä»½(é»˜è®¤ä¸ºnobody ä¸åŒæ“ä½œç³»ç»Ÿä¸åŒï¼Œæ­¤é¡¹ä¸»è¦æ¶‰åŠå®‰å…¨é—®é¢˜)</span>
<span class="hljs-attribute">worker_processes</span> auto;  <span class="hljs-comment"># è‡ªåŠ¨æ ¹æ® CPU æ ¸å¿ƒæ•°è®¾ç½®å·¥ä½œè¿›ç¨‹æ•°é‡ é€šå¸¸ç­‰äºCPUæ ¸å¿ƒæ•°æˆ–è€…ä¸ºå…¶ä¿©å€</span>
<span class="hljs-attribute">error_log</span> /var/log/nginx/<span class="hljs-literal">error</span>.log <span class="hljs-literal">warn</span>;  <span class="hljs-comment"># é”™è¯¯æ—¥å¿—çš„ä½ç½®å’Œçº§åˆ«</span>
<span class="hljs-attribute">pid</span> /run/nginx.pid;  <span class="hljs-comment"># ä¸»è¿›ç¨‹çš„ PID æ–‡ä»¶ä½ç½®</span>

<span class="hljs-comment">### äº‹ä»¶å— ####</span>
<span class="hljs-comment"># useï¼šç”¨æ¥æŒ‡å®šNginxçš„å·¥ä½œæ¨¡å¼ã€‚Nginxæ”¯æŒçš„å·¥ä½œæ¨¡å¼æœ‰selectã€pollã€kqueueã€epollã€rtsigå’Œ/dev/pollã€‚</span>
<span class="hljs-comment"># å…¶ä¸­selectå’Œpolléƒ½æ˜¯æ ‡å‡†çš„å·¥ä½œæ¨¡å¼ï¼Œkqueueå’Œepollæ˜¯é«˜æ•ˆçš„å·¥ä½œæ¨¡å¼ï¼Œä¸åŒçš„æ˜¯epollç”¨åœ¨Linuxå¹³å°ä¸Šï¼Œè€Œkqueueç”¨åœ¨BSDç³»ç»Ÿä¸­ï¼Œå¯¹äºLinuxç³»ç»Ÿï¼Œepollå·¥ä½œæ¨¡å¼æ˜¯é¦–é€‰ã€‚</span>
<span class="hljs-comment">#worker_connectionsï¼šç”¨äºå®šä¹‰Nginxæ¯ä¸ªè¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°ï¼Œå³æ¥æ”¶å‰ç«¯çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œé»˜è®¤æ˜¯1024ã€‚</span>
<span class="hljs-comment"># æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ç”±worker_processeså’Œworker_connectionså†³å®šï¼Œå³Max_clients=worker_processes*worker_connectionsï¼Œ</span>
<span class="hljs-comment"># åœ¨ä½œä¸ºåå‘ä»£ç†æ—¶ï¼Œæœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°é‡ = worker_processes * worker_connections/4ã€‚ </span>
<span class="hljs-comment"># è¿›ç¨‹çš„æœ€å¤§è¿æ¥æ•°å—Linuxç³»ç»Ÿè¿›ç¨‹çš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é™åˆ¶ï¼Œåœ¨æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤â€œulimit -n 65536â€åworker_connectionsçš„è®¾ç½®æ‰èƒ½ç”Ÿæ•ˆã€‚</span>
<span class="hljs-comment">### äº‹ä»¶å— ####</span>
<span class="hljs-section">events</span> &#123;
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">1024</span>;  <span class="hljs-comment"># æ¯ä¸ªå·¥ä½œè¿›ç¨‹å¯ä»¥åŒæ—¶å¤„ç†çš„æœ€å¤§è¿æ¥æ•° é»˜è®¤ä¸º512</span>
    <span class="hljs-attribute">multi_accept</span> <span class="hljs-literal">on</span>;  <span class="hljs-comment">#è®¾ç½®ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œé»˜è®¤ä¸ºoff </span>
    <span class="hljs-attribute">use</span> <span class="hljs-literal">epoll</span>;  <span class="hljs-comment"># ä½¿ç”¨ epoll è¿æ¥å¤„ç†æ¨¡å‹ï¼ˆLinux ç³»ç»Ÿæ¨èï¼‰;äº‹ä»¶é©±åŠ¨æ¨¡å‹</span>
    <span class="hljs-attribute">accept_mutex</span> <span class="hljs-literal">on</span>;   <span class="hljs-comment">#è®¾ç½®ç½‘è·¯è¿æ¥åºåˆ—åŒ–ï¼Œé˜²æ­¢æƒŠç¾¤ç°è±¡å‘ç”Ÿï¼Œé»˜è®¤ä¸ºon</span>
&#125;

<span class="hljs-comment">### HTTP å—  ###</span>
<span class="hljs-comment"># æ­¤å¤„é…ç½®ä¸»è¦åˆ†ä¸ºä¸¤å— serverå—å’Œupstream(å¯é€‰)ï¼Œupstreamä¸ºnginxåå‘ä»£ç†çš„æœåŠ¡å™¨å®•æœºçš„å¤‡ç”¨æœºï¼Œé€šå¸¸é…ç½®æ­¤é¡¹ä¸ºäº†å¢åŠ å®‰å…¨æ€§</span>
<span class="hljs-comment"># serverå—åˆåŒ…æ‹¬locationå—ï¼Œæ¯ä¸ªserverå—éƒ½ç›¸å½“äºä¸€ä¸ªè™šæ‹Ÿçš„ä¸»æœº</span>
<span class="hljs-comment">### HTTP å—  ###</span>
<span class="hljs-section">http</span> &#123;
    <span class="hljs-attribute">include</span>       /etc/nginx/mime.types;  <span class="hljs-comment"># åŒ…å« MIME ç±»å‹å®šä¹‰ è¯¦è§nginx/confç›®å½•ä¸‹ ä¸è®¾ç½®é»˜è®¤æƒ…å†µä¸‹æœ‰å¯èƒ½è¯†åˆ«åˆ°æ— æ³•å¤„ç†çš„MIMEç±»å‹</span>
    <span class="hljs-attribute">default_type</span>  application/octet-stream;  <span class="hljs-comment"># é»˜è®¤ MIME ç±»å‹</span>

    <span class="hljs-attribute">log_format</span>  main  <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span>
                      <span class="hljs-string">&#x27;<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span>
                      <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;  <span class="hljs-comment"># å®šä¹‰è®¿é—®æ—¥å¿—æ ¼å¼</span>

    <span class="hljs-attribute">access_log</span>  /var/log/nginx/access.log  main;  <span class="hljs-comment"># è®¿é—®æ—¥å¿—çš„ä½ç½®å’Œæ ¼å¼</span>

    <span class="hljs-attribute">sendfile</span>        <span class="hljs-literal">on</span>;  <span class="hljs-comment"># å¯ç”¨é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼</span>
    <span class="hljs-attribute">tcp_nopush</span>      <span class="hljs-literal">on</span>;  <span class="hljs-comment"># å‡å°‘ç½‘ç»œåŒ…çš„æ•°é‡</span>
    <span class="hljs-attribute">tcp_nodelay</span>     <span class="hljs-literal">on</span>;  <span class="hljs-comment"># ç¦ç”¨ Nagle ç®—æ³•</span>
    <span class="hljs-attribute">keepalive_timeout</span>  <span class="hljs-number">65</span>;  <span class="hljs-comment"># ä¿æŒè¿æ¥çš„è¶…æ—¶æ—¶é—´</span>

    <span class="hljs-attribute">gzip</span>  <span class="hljs-literal">on</span>;  <span class="hljs-comment"># å¼€å¯ Gzip å‹ç¼©</span>
    <span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">&quot;msie6&quot;</span>;  <span class="hljs-comment"># å¯¹äº IE6 æµè§ˆå™¨ç¦ç”¨ Gzip</span>

    <span class="hljs-comment"># è™šæ‹Ÿä¸»æœºé…ç½®</span>
    <span class="hljs-section">server</span> &#123;
        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;  <span class="hljs-comment"># ç›‘å¬ 80 ç«¯å£</span>
        <span class="hljs-attribute">server_name</span> example.com www.example.com;  <span class="hljs-comment"># æœåŠ¡çš„åŸŸå</span>

        <span class="hljs-comment"># é™æ€æ–‡ä»¶æ ¹ç›®å½•</span>
        <span class="hljs-attribute">root</span> /var/www/html;
        <span class="hljs-attribute">index</span> index.html index.htm;  <span class="hljs-comment"># é»˜è®¤ç´¢å¼•æ–‡ä»¶</span>

        <span class="hljs-comment"># å¤„ç†æ‰€æœ‰è¯·æ±‚</span>
        <span class="hljs-section">location</span> / &#123;
            <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ =<span class="hljs-number">404</span>;  <span class="hljs-comment"># å°è¯•æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸å­˜åœ¨åˆ™è¿”å› 404ï¼Œæ­¤å¤„$uriä¸ºå½“å‰è¯·æ±‚è·¯å¾„/exåˆ™å…ˆæŸ¥è¯¢æ˜¯å¦æœ‰exçš„æ–‡ä»¶ï¼Œè‹¥æ— åˆ™è®¿é—®æ­¤ç›®å½•</span>
        &#125;

        <span class="hljs-comment"># å¤„ç†ç‰¹å®šè·¯å¾„ä¸‹çš„è¯·æ±‚</span>
        <span class="hljs-section">location</span> /images/ &#123;
            <span class="hljs-attribute">autoindex</span> <span class="hljs-literal">on</span>;  <span class="hljs-comment"># å¯ç”¨ç›®å½•åˆ—è¡¨åŠŸèƒ½</span>
            <span class="hljs-attribute">autoindex_exact_size</span> <span class="hljs-literal">off</span>;  <span class="hljs-comment"># ä¸æ˜¾ç¤ºæ–‡ä»¶çš„ç¡®åˆ‡å¤§å°</span>
            <span class="hljs-attribute">autoindex_localtime</span> <span class="hljs-literal">on</span>;  <span class="hljs-comment"># æ˜¾ç¤ºæœ¬åœ°æ—¶é—´</span>
        &#125;

        <span class="hljs-comment"># é”™è¯¯é¡µé¢</span>
        <span class="hljs-attribute">error_page</span> <span class="hljs-number">404</span> /<span class="hljs-number">404</span>.html;
        <span class="hljs-section">location</span> = /<span class="hljs-number">404</span>.html &#123;
            internal;  <span class="hljs-comment"># åªèƒ½ç”±å†…éƒ¨é‡å®šå‘è®¿é—®</span>
        &#125;
    &#125;

    <span class="hljs-comment"># åå‘ä»£ç†é…ç½®</span>
    <span class="hljs-section">server</span> &#123;
        <span class="hljs-attribute">listen</span> <span class="hljs-number">8080</span>;  <span class="hljs-comment"># ç›‘å¬ 8080 ç«¯å£</span>
        <span class="hljs-attribute">server_name</span> proxy.example.com;

        <span class="hljs-section">location</span> / &#123;
            <span class="hljs-attribute">proxy_pass</span> https://backend;  <span class="hljs-comment"># åå‘ä»£ç†åˆ°åç«¯æœåŠ¡å™¨</span>
            <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;  <span class="hljs-comment"># ä¼ é€’åŸå§‹ Host è¯·æ±‚å¤´</span>
            <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;  <span class="hljs-comment"># ä¼ é€’å®¢æˆ·ç«¯ IP åœ°å€</span>
        &#125;
    &#125;

    <span class="hljs-comment"># ä¸Šæ¸¸æœåŠ¡å™¨ç»„</span>
    <span class="hljs-section">upstream</span> backend &#123;
        <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.1.1:8081</span>;  <span class="hljs-comment"># ç¬¬ä¸€ä¸ªåç«¯æœåŠ¡å™¨</span>
        <span class="hljs-attribute">server</span> <span class="hljs-number">192.168.1.2:8081</span>;  <span class="hljs-comment"># ç¬¬äºŒä¸ªåç«¯æœåŠ¡å™¨</span>
    &#125;
&#125;
</code></pre>
            </div>
        </article>
    </div>
    <br>
    
        <div class="next-prev-post">
            
                <div class="prev-post">
                    <div class="prev gt-c-content-color-first">
                        ä¸Šä¸€ç¯‡ï¼š<a href="/2024/10/09/ex/" 
                            class="post-title gt-a-link">ex</a>
                    </div>
                </div>
            
            
                <div class="next-post">
                    <div class="next gt-c-content-color-first">
                        ä¸‹ä¸€ç¯‡ï¼š<a href="/2024/09/25/hello-world/" 
                            class="post-title gt-a-link">ä½ å¥½æ–‡å½¬</a>
                    </div>
                </div>
            
        </div>
    
    

    

    
</div>

                <div class="site-footer gt-c-content-color-first">
    <div class="footer-main">
        <!-- å»ºè®®ä¿ç•™ç‰ˆæƒä¿¡æ¯æˆ–è€…æ·»åŠ ä¸»é¢˜ä¿¡æ¯åˆ°å‹é“¾ï¼Œæ„Ÿè°¢æ‚¨çš„ç†è§£ -->
        <!-- æ–‡ä»¶ä½ç½®ï¼šlayout/_includes/footer.ejs -->
        <span style="text-align: right; float: right;">Theme <a 
            href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a> | Powered by <a 
            href="https://hexo.io" target="_blank">Hexo</a></span>
        <span style="text-align: left;">Footer HTML
</span>
    </div>
</div>

            </div>
        </div>
    </body>
</html>